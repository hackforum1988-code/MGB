-- Diagnostic quick check
local brainrots = workspace:FindFirstChild("Brainrots")
local held = workspace:FindFirstChild("HeldBrainrots")
local plots = workspace:FindFirstChild("Plots")

print("=== Brainrots in Workspace ===")
if brainrots then
	for _, m in ipairs(brainrots:GetChildren()) do
		if m:IsA("Model") then
			local s = m:FindFirstChild("StoredInSlot")
			local owner = m:FindFirstChild("Owner") and m.Owner.Value or "nil"
			print("BRAINROT:", m.Name, "parent:", m.Parent and m.Parent:GetFullName() or "nil", "StoredInSlot:", (s and s.Value) or "nil", "Owner:", owner, "TransparencySample:",
				(function()
					local t = nil
					for _, p in ipairs(m:GetDescendants()) do
						if p:IsA("BasePart") then t = p.Transparency; break end
					end
					return t or "nil"
				end)()
			)
		else
			print("NON-MODEL IN Brainrots:", m:GetFullName(), m.ClassName)
		end
	end
else
	print("No Brainrots folder")
end

print("=== HeldBrainrots ===")
if held then
	for _, m in ipairs(held:GetChildren()) do
		print("HELD:", m.Name, "parent:", m.Parent and m.Parent:GetFullName() or "nil")
		for _, d in ipairs(m:GetDescendants()) do
			if d:IsA("StringValue") and d.Name == "StoredInSlot" then
				print("  descendant StoredInSlot:", d.Value)
			end
		end
	end
else
	print("No HeldBrainrots folder")
end

print("=== Slot occupancy summary ===")
if plots then
	for _, plot in ipairs(plots:GetChildren()) do
		for _, slot in ipairs(plot:GetChildren()) do
			if type(slot.Name) == "string" and slot.Name:match("^Slot") then
				local list = {}
				for _, m in ipairs(brainrots and brainrots:GetChildren() or {}) do
					if m:IsA("Model") then
						local s = m:FindFirstChild("StoredInSlot")
						if s and s.Value == slot.Name then
							table.insert(list, m)
						end
					end
				end
				if #list > 0 then
					print("Plot", plot.Name, "Slot", slot.Name, "count:", #list, "OccupiedAttr:", slot:GetAttribute("Occupied"))
					for i, inst in ipairs(list) do
						print("   ", i, inst.Name, inst:GetFullName())
					end
				end
			end
		end
	end
end
