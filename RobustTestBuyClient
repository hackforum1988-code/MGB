-- RobustTestBuyClient (LocalScript in StarterPlayerScripts)
print("[TEST] RobustTestBuyClient started")

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local player = Players.LocalPlayer
if not player then
	warn("[TEST] No LocalPlayer found")
	return
end

-- Warte kurz, bis andere PlayerScripts geladen sind
task.wait(1)

-- 1) Existenz der Remote prüfen
local pickupRemote = ReplicatedStorage:FindFirstChild("BrainrotPickup")
print("[TEST] ReplicatedStorage.BrainrotPickup exists:", tostring(pickupRemote ~= nil))

-- 2) Prüfe ob _G helper vorhanden ist
local hasHelper = (_G and _G.Client_BrainrotHelpers and type(_G.Client_BrainrotHelpers.RequestPickup) == "function")
print("[TEST] _G.Client_BrainrotHelpers present:", tostring(hasHelper))

-- 3) Wenn Helper vorhanden -> benutze ihn, sonst versuche direkt das Remote zu feuern
local modelName = "Brr Brr Patapim" -- ersetze falls du einen anderen Namen testen willst

if hasHelper then
	print("[TEST] Calling _G.Client_BrainrotHelpers.RequestPickup with:", modelName)
	local ok, err = pcall(function() _G.Client_BrainrotHelpers.RequestPickup(modelName) end)
	print("[TEST] Helper call ok:", tostring(ok), "err:", tostring(err))
else
	if pickupRemote then
		print("[TEST] Calling pickupRemote:FireServer directly with:", modelName)
		local ok, err = pcall(function() pickupRemote:FireServer(modelName) end)
		print("[TEST] Direct FireServer ok:", tostring(ok), "err:", tostring(err))
	else
		warn("[TEST] Kein BrainrotPickup Remote in ReplicatedStorage gefunden")
	end
end

-- Optional: nochmal nach kurzer Wartezeit prüfen, ob etwas im Workspace/HeldBrainrots erschienen ist
task.delay(1, function()
	local hb = workspace:FindFirstChild("HeldBrainrots")
	print("[TEST] HeldBrainrots folder present:", tostring(hb ~= nil))
	if hb then
		for _, c in ipairs(hb:GetChildren()) do
			if c:FindFirstChild("Owner") and c.Owner.Value == player.Name then
				print("[TEST] Found held model in HeldBrainrots:", c.Name)
			end
		end
	end
end)
